(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-plugins-distribution-extraction-apply-extraction-apply"],{"0d32":function(t,a,e){var i=e("24fb");a=i(!1),a.push([t.i,"/*\r\n* 三级联动\r\n*/.select-address[data-v-ac4679e8]{box-sizing:border-box;height:%?70?%;line-height:%?70?%;padding:0 %?10?%}.select-address .section[data-v-ac4679e8]{width:33.33%;box-sizing:border-box}.select-address .section[data-v-ac4679e8]:not(:first-child){padding:0 %?5?%}",""]),t.exports=a},"22eb":function(t,a,e){var i=e("0d32");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("4f06").default;n("698950cd",i,!0,{sourceMap:!1,shadowMode:!1})},3256:function(t,a,e){"use strict";var i=e("22eb"),n=e.n(i);n.a},8852:function(t,a,e){"use strict";e.r(a);var i=e("8e01"),n=e.n(i);for(var l in i)["default"].indexOf(l)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(l);a["default"]=n.a},"8a90":function(t,a,e){"use strict";e.r(a);var i=e("8c7b"),n=e("8852");for(var l in n)["default"].indexOf(l)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(l);e("3256");var s=e("f0c5"),o=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"ac4679e8",null,!1,i["a"],void 0);a["default"]=o.exports},"8c7b":function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return n})),e.d(a,"a",(function(){}));var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"page-bottom-fixed"},[e("v-uni-form",{staticClass:"form-container",on:{submit:function(a){arguments[0]=a=t.$handleEvent(a),t.form_submit.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"padding-main oh"},[e("v-uni-view",{staticClass:"form-gorup bg-white form-container-upload oh"},[e("v-uni-view",{staticClass:"form-gorup-title"},[t._v("logo图片"),e("v-uni-text",{staticClass:"form-group-tips"},[t._v("选传，建议300x300px")])],1),e("v-uni-view",{staticClass:"oh"},[e("v-uni-view",{staticClass:"form-upload-data fl"},[null!=(t.extraction_data.logo||null)?[e("v-uni-view",{staticClass:"item fl"},[e("v-uni-text",{staticClass:"delete-icon",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.upload_delete_event.apply(void 0,arguments)}}},[t._v("x")]),e("v-uni-image",{attrs:{src:t.extraction_data.logo,mode:"aspectFill"},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.upload_show_event.apply(void 0,arguments)}}})],1)]:t._e()],2),e("v-uni-image",{staticClass:"upload-icon",attrs:{src:t.common_static_url+"upload-icon.png",mode:"aspectFill"},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.file_upload_event.apply(void 0,arguments)}}})],1)],1),e("v-uni-view",{staticClass:"form-gorup bg-white"},[e("v-uni-view",{staticClass:"form-gorup-title"},[t._v("别名")]),e("v-uni-input",{staticClass:"cr-base",attrs:{type:"text",name:"alias",value:t.extraction_data.alias||"","placeholder-class":"cr-grey",placeholder:"别名格式最多 16 个字符"}})],1),e("v-uni-view",{staticClass:"form-gorup bg-white"},[e("v-uni-view",{staticClass:"form-gorup-title"},[t._v("联系人"),e("v-uni-text",{staticClass:"form-group-tips-must"},[t._v("*")])],1),e("v-uni-input",{staticClass:"cr-base",attrs:{type:"text",name:"name",value:t.extraction_data.name||"","placeholder-class":"cr-grey",placeholder:"联系人格式 2~16 个字符之间"}})],1),e("v-uni-view",{staticClass:"form-gorup bg-white"},[e("v-uni-view",{staticClass:"form-gorup-title"},[t._v("联系电话"),e("v-uni-text",{staticClass:"form-group-tips-must"},[t._v("*")])],1),e("v-uni-input",{staticClass:"cr-base",attrs:{type:"text",name:"tel",value:t.extraction_data.tel||"","placeholder-class":"cr-grey",placeholder:"座机 或 手机"}})],1),e("v-uni-view",{staticClass:"form-gorup bg-white"},[e("v-uni-view",{staticClass:"form-gorup-title"},[t._v("省市区"),e("v-uni-text",{staticClass:"form-group-tips-must"},[t._v("必选")])],1),e("v-uni-view",{staticClass:"select-address oh"},[e("v-uni-view",{staticClass:"section fl"},[e("v-uni-picker",{attrs:{name:"province",value:t.province_value,range:t.province_list,"range-key":"name"},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.select_province_event.apply(void 0,arguments)}}},[e("v-uni-view",{class:"name "+(null==t.province_value?"cr-grey":"cr-base")},[t._v(t._s(null==(t.province_list[t.province_value]||null)?t.default_province:t.province_list[t.province_value]["name"]))])],1)],1),e("v-uni-view",{staticClass:"section fl"},[null!=(t.province_id||null)?e("v-uni-picker",{attrs:{name:"city",value:t.city_value,range:t.city_list,"range-key":"name"},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.select_city_event.apply(void 0,arguments)}}},[e("v-uni-view",{class:"name "+(null==t.city_value?"cr-grey":"cr-base")},[t._v(t._s(null==(t.city_list[t.city_value]||null)?t.default_city:t.city_list[t.city_value]["name"]))])],1):e("v-uni-text",{staticClass:"cr-grey",attrs:{"data-value":"请先选择省份"},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.region_select_error_event.apply(void 0,arguments)}}},[t._v("请先选择省份")])],1),e("v-uni-view",{staticClass:"section fl"},[null!=(t.city_id||null)?e("v-uni-picker",{attrs:{name:"county",value:t.county_value,range:t.county_list,"range-key":"name"},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.select_county_event.apply(void 0,arguments)}}},[e("v-uni-view",{class:"name "+(null==t.county_value?"cr-grey":"cr-base")},[t._v(t._s(null==(t.county_list[t.county_value]||null)?t.default_county:t.county_list[t.county_value]["name"]))])],1):e("v-uni-text",{staticClass:"cr-grey",attrs:{"data-value":"请先选择城市"},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.region_select_error_event.apply(void 0,arguments)}}},[t._v("请先选择城市")])],1)],1)],1),e("v-uni-view",{staticClass:"form-gorup bg-white"},[e("v-uni-view",{staticClass:"form-gorup-title"},[t._v("详细地址"),e("v-uni-text",{staticClass:"form-group-tips-must"},[t._v("*")])],1),e("v-uni-input",{staticClass:"cr-base",attrs:{type:"text",name:"address",value:t.extraction_data.address||"","placeholder-class":"cr-grey",placeholder:"详细地址格式 1~80 个字符之间"}})],1),e("v-uni-view",{staticClass:"form-gorup bg-white"},[e("v-uni-view",{staticClass:"form-gorup-title"},[t._v("地理位置"),e("v-uni-text",{staticClass:"form-group-tips-must"},[t._v("必选")])],1),e("v-uni-view",{staticClass:"form-gorup-text",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.choose_location_event.apply(void 0,arguments)}}},[null==(t.user_location||null)?e("v-uni-view",{staticClass:"cr-gray"},[t._v("请选择地理位置")]):e("v-uni-view",{staticClass:"cr-base"},[t._v(t._s(t.user_location.lng)+", "+t._s(t.user_location.lat))])],1)],1),null!=(t.extraction_data||null)&&1==(t.extraction_data.status||0)?e("v-uni-view",{staticClass:"notice-content-blue spacing-mb"},[t._v("注意：编辑信息将重新审核后方可生效")]):t._e(),e("v-uni-view",{staticClass:"bottom-fixed padding-main"},[e("v-uni-button",{staticClass:"bg-main br-main cr-white round text-size",attrs:{type:"default","form-type":"submit","hover-class":"none",disabled:t.form_submit_disabled_status}},[t._v("提交")])],1)],1)],1)],1)},n=[]},"8e01":function(t,a,e){"use strict";e("7a82");var i=e("4ea4").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=i(e("53ca"));e("d3b7"),e("159b");var l=getApp(),s=l.globalData.get_static_url("common"),o={data:function(){return{common_static_url:s,params:null,data_list_loding_status:1,data_list_loding_msg:"",extraction_data:{},province_list:[],city_list:[],county_list:[],province_id:null,city_id:null,county_id:null,editor_path_type:"",default_province:"请选择省",default_city:"请选择市",default_county:"请选择区/县",province_value:null,city_value:null,county_value:null,user_location_cache_key:l.globalData.data.cache_userlocation_key,user_location:null,form_submit_disabled_status:!1}},components:{},props:{},onLoad:function(t){this.setData({params:t})},onReady:function(){uni.removeStorage({key:this.user_location_cache_key}),this.init()},onShow:function(){this.user_location_init(),l.globalData.page_share_handle()},methods:{init:function(){var t=l.globalData.get_user_info(this,"init");if(0!=t){if(l.globalData.user_is_need_login(t))return uni.redirectTo({url:"/pages/login/login?event_callback=init"}),this.setData({data_list_loding_status:2,data_list_loding_msg:"请先绑定手机号码"}),!1;this.get_province_list(),this.applyinfo_init()}else this.setData({data_list_loding_status:2,data_list_loding_msg:"请先授权用户信息"})},applyinfo_init:function(){var t=this;uni.request({url:l.globalData.get_request_url("applyinfo","extraction","distribution"),method:"POST",data:{},dataType:"json",success:function(a){if(0==a.data.code){var e=a.data.data,i=e.extraction_data||null;if(t.setData({extraction_data:i||{},editor_path_type:e.editor_path_type||""}),null!=i){t.setData({province_id:i.province||null,city_id:i.city||null,county_id:i.county||null});var n=i.lng||0,s=i.lat||0;0!=n&&0!=s&&t.setData({user_location:{lng:n,lat:s,address:i.address||""}})}t.get_city_list(),t.get_county_list(),setTimeout((function(){t.init_region_value()}),500)}else l.globalData.is_login_check(a.data)&&l.globalData.showToast(a.data.msg)},fail:function(){l.globalData.showToast("省份信息失败")}})},init_region_value:function(){this.setData({province_value:this.get_region_value("province_list","province_id"),city_value:this.get_region_value("city_list","city_id"),county_value:this.get_region_value("county_list","county_id")})},get_region_value:function(t,a){var e=this[t],i=this[a],n=null;return e.forEach((function(t,a){if(t.id==i)return n=a,!1})),n},get_province_list:function(){var t=this;uni.request({url:l.globalData.get_request_url("index","region"),method:"POST",data:{},dataType:"json",success:function(a){if(0==a.data.code){var e=a.data.data;t.setData({province_list:e})}else l.globalData.showToast(a.data.msg)},fail:function(){l.globalData.showToast("省份获取失败")}})},get_city_list:function(){var t=this;t.province_id&&uni.request({url:l.globalData.get_request_url("index","region"),method:"POST",data:{pid:t.province_id},dataType:"json",success:function(a){if(0==a.data.code){var e=a.data.data;t.setData({city_list:e})}else l.globalData.showToast(a.data.msg)},fail:function(){l.globalData.showToast("城市获取失败")}})},get_county_list:function(){var t=this;t.city_id&&uni.request({url:l.globalData.get_request_url("index","region"),method:"POST",data:{pid:t.city_id},dataType:"json",success:function(a){if(0==a.data.code){var e=a.data.data;t.setData({county_list:e})}else l.globalData.showToast(a.data.msg)},fail:function(){l.globalData.showToast("区/县获取失败")}})},select_province_event:function(t){var a=t.detail.value||0;if(a>=0){var e=this.province_list[a];this.setData({province_value:a,province_id:e.id,city_value:null,county_value:null,city_id:null,county_id:null}),this.get_city_list()}},select_city_event:function(t){var a=t.detail.value||0;if(a>=0){var e=this.city_list[a];this.setData({city_value:a,city_id:e.id,county_value:null,county_id:null}),this.get_county_list()}},select_county_event:function(t){var a=t.detail.value||0;if(a>=0){var e=this.county_list[a];this.setData({county_value:a,county_id:e.id})}},region_select_error_event:function(t){var a=t.currentTarget.dataset.value||null;null!=a&&l.globalData.showToast(a)},choose_location_event:function(t){uni.navigateTo({url:"/pages/common/open-setting-location/open-setting-location"})},user_location_init:function(){var t=uni.getStorageSync(this.user_location_cache_key)||null,a=null;null!=t&&(a={name:t.name||null,address:t.address||null,lat:t.latitude||null,lng:t.longitude||null}),this.setData({user_location:a})},form_submit:function(t){var a=this,e=t.detail.value;e["logo"]=null!=(this.extraction_data||null)&&this.extraction_data.logo||"",e["province"]=a.province_id,e["city"]=a.city_id,e["county"]=a.county_id;var i=0,n=0;null!=(a.user_location||null)&&(i=a.user_location.lng||0,n=a.user_location.lat||0),null!=(a.extraction_data||null)&&(null==(i||null)&&(i=a.extraction_data.lng||0),null==(n||null)&&(n=a.extraction_data.lat||0)),e["lng"]=i,e["lat"]=n,l.globalData.fields_check(e,[{fields:"name",msg:"请填写联系人"},{fields:"tel",msg:"请填写联系电话"},{fields:"province",msg:"请选择省份"},{fields:"city",msg:"请选择城市"},{fields:"county",msg:"请选择区县"},{fields:"address",msg:"请填写详细地址"},{fields:"lng",msg:"请选择地理位置"},{fields:"lat",msg:"请选择地理位置"}])&&(null!=(a.extraction_data||null)&&1==(a.extraction_data.status||0)?uni.showModal({title:"温馨提示",content:"数据需重新审核后方可生效",confirmText:"确认",cancelText:"暂不",success:function(t){t.confirm&&a.request_data_save(e)}}):a.request_data_save(e))},request_data_save:function(t){var a=this;a.setData({form_submit_disabled_status:!0}),uni.showLoading({title:"处理中..."}),uni.request({url:l.globalData.get_request_url("applysave","extraction","distribution"),method:"POST",data:t,dataType:"json",success:function(t){uni.hideLoading(),0==t.data.code?(l.globalData.showToast(t.data.msg,"success"),setTimeout((function(){uni.navigateBack()}),1e3)):(a.setData({form_submit_disabled_status:!1}),l.globalData.is_login_check(t.data)?l.globalData.showToast(t.data.msg):l.globalData.showToast("提交失败，请重试！"))},fail:function(){a.setData({form_submit_disabled_status:!1}),uni.hideLoading(),l.globalData.showToast("服务器请求出错")}})},upload_show_event:function(t){uni.previewImage({current:this.extraction_data.logo,urls:[this.extraction_data.logo]})},upload_delete_event:function(t){var a=this;uni.showModal({title:"温馨提示",content:"删除后不可恢复、继续吗？",success:function(t){if(t.confirm){var e=a.extraction_data||{};e["logo"]="",a.setData({extraction_data:e})}}})},file_upload_event:function(t){var a=this;uni.chooseImage({count:1,success:function(t){var e=t.tempFilePaths.length;a.upload_one_by_one(t.tempFilePaths,0,0,0,e)}})},upload_one_by_one:function(t,a,e,i,s){var o=this;uni.uploadFile({url:l.globalData.get_request_url("index","ueditor"),filePath:t[i],name:"upfile",formData:{action:"uploadimage",path_type:o.editor_path_type},success:function(t){if(a++,200==t.statusCode){var e="object"==(0,n.default)(t.data)?t.data:JSON.parse(t.data);if(0==e.code&&null!=(e.data.url||null)){var i=o.extraction_data||{};i["logo"]=e.data.url,o.setData({extraction_data:i})}else l.globalData.showToast(e.msg)}},fail:function(t){e++},complete:function(n){i++,i>=s||o.upload_one_by_one(t,a,e,i,s)}})}}};a.default=o}}]);